<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Font Switch Test</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Qahiri&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Barrio&family=Barriecito&family=Baumans&family=Bungee+Inline&family=Londrina+Solid&family=Chango&family=Denk+One&family=Jacques+Francois+Shadow&family=Jaini&family=Moirai+One&family=Palette+Mosaic&family=Phudu&family=Pixelify+Sans&family=Silkscreen&family=VT323&family=Plaster&family=Rubik+Vinyl&family=Rubik+Glitch&family=Sedgwick+Ave+Display&family=Syncopate&family=Tapestry&family=Tilt+Prism&family=Shizuru&family=Sixtyfour&family=Special+Elite&family=Workbench&family=Yomogi&display=swap" rel="stylesheet" />

  <!-- FontFaceObserver -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fontfaceobserver/2.1.0/fontfaceobserver.standalone.js"></script>

  <style>
    html, body {
      background: #000;
      margin: 0;
      padding: 0;
      color: #F6E6E1;
      font-family: 'Qahiri', sans-serif;
      overflow-x: hidden;
      overflow-y: auto;
      height: 100%;
    }

    .wrapper {
      position: fixed;
      top: 50%;
      left: 0;           /* flush left edge */
      transform: translateY(-50%);
      height: 33vh;
      display: flex;
      align-items: center;
      pointer-events: none;
      user-select: none;
      z-index: 10;
    }

    .random-font-text {
      font-size: 12vw;
      line-height: 1;
      color: #f36210;
      transition: font-family 0.25s ease, filter 0.15s ease;
      filter: none;
      white-space: nowrap;
      font-weight: 400 !important;
      -webkit-text-stroke: 0 !important;
      text-stroke: 0 !important;
      text-align: left;
      /* Change origin to center for proper centering */
      transform-origin: center center;
      pointer-events: auto;
      user-select: text;
      /* Start with no transform, will be set in JS */
    }

    .random-font-text.blur {
      filter: blur(5px);
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="random-font-text">Asherel's</div>
  </div>

  <script>
    const fonts = [
      'Barrio', 'Barriecito', 'Baumans', 'Bungee Inline', 'Londrina Solid',
      'Chango', 'Denk One', 'Jacques Francois Shadow', 'Jaini', 'Moirai One',
      'Palette Mosaic', 'Phudu', 'Pixelify Sans', 'Silkscreen', 'VT323',
      'Plaster', 'Qahiri', 'Rubik Vinyl', 'Rubik Glitch', 'Sedgwick Ave Display',
      'Syncopate', 'Tapestry', 'Tilt Prism', 'Shizuru', 'Sixtyfour', 'Special Elite',
      'Workbench', 'Yomogi'
    ];

    const fontWidths = {
      'Barrio': 11, 'Barriecito': 9.3, 'Baumans': 8.75, 'Bungee Inline': 14, 'Londrina Solid': 8.3,
      'Chango': 14, 'Denk One': 9.75, 'Jacques Francois Shadow': 10.5, 'Jaini': 7.4, 'Moirai One': 11.385,
      'Palette Mosaic': 10.584, 'Phudu': 9.8, 'Pixelify Sans': 10.75, 'Silkscreen': 13.25, 'VT323': 7.75,
      'Plaster': 14, 'Qahiri': 6.138, 'Rubik Vinyl': 11.8, 'Rubik Glitch': 11.8, 'Sedgwick Ave Display': 9.25,
      'Syncopate': 16.25, 'Tapestry': 8.8, 'Tilt Prism': 10.908, 'Shizuru': 9.207, 'Sixtyfour': 19.15,
      'Special Elite': 10.89, 'Workbench': 9.8, 'Yomogi': 9.504
    };

    let textElement = document.querySelector('.random-font-text');
    let isFontChanging = false;
    let autoSwitchTimeout;
    let lastChangeTime = 0;
    let lastFont = null;

    fonts.forEach(font => {
      new FontFaceObserver(font).load().catch(() => {
        console.warn(`Failed to load ${font}`);
      });
    });

    function getRandomFont() {
      let font;
      do {
        font = fonts[Math.floor(Math.random() * fonts.length)];
      } while (font === lastFont);
      lastFont = font;
      return font;
    }

    function changeFontSmoothly() {
      const now = Date.now();
      if (isFontChanging || now - lastChangeTime < 300) return;

      isFontChanging = true;
      textElement.classList.add('blur');

      const nextFont = getRandomFont();

      new FontFaceObserver(nextFont).load().then(() => {
        setTimeout(() => {
          textElement.style.fontFamily = `"${nextFont}", sans-serif`;

          const measuredWidth = fontWidths[nextFont] || 6.2;
          const scaleX = 6.2 / measuredWidth;

          // TranslateX 50% moves center of rotated text to the left edge of screen
          textElement.style.transform = `rotate(-90deg) translateX(50%) scaleX(${scaleX.toFixed(3)})`;
        }, 40);

        setTimeout(() => {
          textElement.classList.remove('blur');
          isFontChanging = false;
          lastChangeTime = Date.now();
          scheduleNextFontChange();
        }, 100);
      }).catch(() => {
        console.warn(`Failed to load ${nextFont}`);
        textElement.classList.remove('blur');
        isFontChanging = false;
        lastChangeTime = Date.now();
        scheduleNextFontChange();
      });
    }

    function scheduleNextFontChange() {
      clearTimeout(autoSwitchTimeout);
      autoSwitchTimeout = setTimeout(changeFontSmoothly, 5000);
    }

    window.addEventListener('load', () => {
      const initialFont = getRandomFont();
      textElement.style.fontFamily = `"${initialFont}", sans-serif`;
      const initialWidth = fontWidths[initialFont] || 6.2;
      const scaleX = 6.2 / initialWidth;
      textElement.style.transform = `rotate(-90deg) translateX(50%) scaleX(${scaleX.toFixed(3)})`;
      scheduleNextFontChange();
    });

    textElement.addEventListener('mouseover', changeFontSmoothly);
  </script>
</body>
</html>
